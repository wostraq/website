{% macro sidenavmenu(endpointprefix,pagename) %}
 <li
 {%- if request.endpoint.startswith(endpointprefix) -%}
  class="active"
 {%- endif -%}
 >
 
 <a href="#{{- endpointprefix.replace('.','_') -}}Submenu" data-toggle="collapse" aria-expanded="false">{{pagename}}</a>
 <ul class="collapse list-unstyled" id="{{- endpointprefix.replace('.','_') -}}Submenu">
{% endmacro %}

{% macro sidenavitem(endpoint,pagename) %}
<li
 {%- if request.endpoint == endpoint -%}
  class="active"
 {%- endif -%}
 >
 <a href="{{url_for(endpoint)}}">{{pagename}}</a></li>
{% endmacro %}



<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="WOSTRAQ - West of Scotland Trainees Research, Audit and QI network">
        <meta name="author" content="WOSTRAQ">
        <meta name="csrf-token" content="{{ csrf_token() }}">
        <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">

        <title>
        {% block title %}
            {%- if not page_title -%}
                 WOSTRAQ
            {%- else -%}
                {{ page_title }} - WOSTRAQ
            {%- endif -%}
        {% endblock %}
        </title>

        {% block stylesheets %}
        <!-- bootstrap css -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
        <link rel="stylesheet" href="/static/css/style.css">
        <!-- lato font -->
        <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
        {% endblock %}

        {# for extra stylesheets. e.q. a template has to add something #}
        {% block css %}
        {% endblock %}

        {# for various extra things #}
        {% block head_extra %}
        {% endblock %}
    </head>

    <body>
        <div class="wrapper">

           <!-- Sidebar -->
           <nav id="sidebar">
           <!-- Sidebar Header -->
           <div class="sidebar-header">
              <h3>WOSTRAQ</div>
           </div>

           <!-- Sidebar Links -->
           <ul class="list-unstyled components">
              {{sidenavitem('home.index','Home')}}
              {{sidenavitem('home.about','About')}}
              {{sidenavmenu('home.pages','Pages')}}
                    {{sidenavitem('home.pages_1','Page1')}}
                    {{sidenavitem('home.pages_2','Page2')}}
                    {{sidenavitem('home.pages_3','Page3')}}
                </ul>

              <li><a href="#">Portfolio</a></li>
              <li><a href="#">Contact</a></li>
          </ul>
          </nav>

           <!-- Page Content -->
              <div id="content">
                  <button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn">
                  <i class="glyphicon glyphicon-align-left"></i>
                  Toggle Sidebar
                  </button>
                 Lorem ipsum etc
              </div>

        </div>       
        <!-- main forum layout -->
        <div class="flaskbb-layout">
            <div class="container">

                <!-- forum header - place for the project title and subtitle -->
                {% block header %}
                <div class="flaskbb-header">
                    <div class="flaskbb-meta">
                        <div class="flaskbb-title">{{ flaskbb_config["PROJECT_TITLE"] }}</div>
                        <div class="flaskbb-subtitle">{{ flaskbb_config["PROJECT_SUBTITLE"] }}</div>
                    </div>
                </div>
                {% endblock %}

                <!-- forum menu - contains all the navigation items -->
                
                {% block navigation %}
                <div class="navbar navbar-default" role="navigation">
                    
                    <div class="collapse navbar-collapse" id="navbar-collapse">
                        <!-- navbar left -->
                        <ul class="nav navbar-nav forum-nav">
                            {%- from theme("macros.html") import is_active, topnav with context -%}

                            {{ run_hook("flaskbb_tpl_before_navigation") }}
                            {{ topnav(endpoint='forum.index', name=_('Forum'), icon='fa fa-comment', active=active_forum_nav) }}
                            {{ topnav(endpoint='forum.memberlist', name=_('Memberlist'), icon='fa fa-user') }}
                            {{ topnav(endpoint='forum.search', name=_('Search'), icon='fa fa-search') }}
                            {{ run_hook("flaskbb_tpl_after_navigation") }}
                        </ul>

                        <!-- navbar right -->
                        <ul class="nav navbar-nav navbar-right">

                            {% if current_user and current_user.is_authenticated %}
                            <!-- Inbox -->
                            <li class="dropdown {{ is_active('message.inbox') }}">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    <span class="fa fa-envelope fa-fw"></span> {% trans %}Inbox{% endtrans %}
                                    {% if current_user.unread_count > 0 %}
                                    <span class="label label-danger">{{ current_user.unread_count }}</span>
                                    {% else %}
                                    <span class="label label-info">{{ current_user.unread_count }}</span>
                                    {% endif %}
                                </a>
                                <ul class="dropdown-menu dropdown-messages">
                                    {% for message in current_user.unread_messages %}
                                    <li>
                                        <a href="{{ url_for('message.view_conversation', conversation_id=message.id) }}">
                                            <div>
                                                <span class="author-name">{{ message.from_user.username }}</span> <span class="pull-right text-muted">{{ message.last_message.date_created|time_since }}</span>
                                                <div class="message-subject">{{ message.subject }}</div>
                                            </div>
                                        </a>
                                    </li>
                                    {% else %}
                                    <li><a href="#">No unread messages.</a></li>
                                    {% endfor %}
                                    <li class="divider"></li>
                                    <li><a href="{{ url_for('message.inbox') }}"><span class="fa fa-envelope fa-fw"></span> {% trans %}Inbox{% endtrans %}</a></li>
                                    <li><a href="{{ url_for('message.new_conversation') }}"><span class="fa fa-pencil fa-fw"></span> {% trans %}New Message{% endtrans %}</a></li>
                                </ul>
                            </li>

                            <!-- User Menu -->
                            <li>
                                <div class="btn-group navbar-btn user-btn">
                                    <a class="btn btn-primary" href="{{ url_for('user.profile', username=current_user.username) }}">
                                        <span class="fa fa-user fa-fw"></span> {{ current_user.username }}
                                    </a>
                                    <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>
                                    <ul class="dropdown-menu" role="menu">
                                        <li><a href="{{ url_for('forum.topictracker') }}"><span class="fa fa-book fa-fw"></span> {% trans %}Topic Tracker{% endtrans %}</a></li>
                                        <li class="divider"></li>

                                        <li><a href="{{ url_for('user.settings') }}"><span class="fa fa-cogs fa-fw"></span> {% trans %}Settings{% endtrans %}</a></li>
                                        {% if current_user|is_admin_or_moderator %}
                                        <li><a href="{{ url_for('management.overview') }}"><span class="fa fa-cog fa-fw"></span> {% trans %}Management{% endtrans %}</a></li>
                                        <li class="divider"></li>
                                        {% endif %}

                                        <li><a href="{{ url_for('auth.logout') }}"><span class="fa fa-power-off fa-fw"></span> {% trans %}Logout{% endtrans %}</a></li>
                                    </ul>
                                </div>
                            </li>
                            {% else %}
                            <!-- Not logged in - Login/Register -->
                            <li>
                                <div class="btn-group navbar-btn user-btn">
                                    <a class="btn btn-primary" href="{{ url_for('auth.login') }}">
                                        <span class="fa fa-user fa-fw"></span> {% trans %}Login{% endtrans %}
                                    </a>
                                    <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>
                                    <ul class="dropdown-menu" role="menu">
                                        {% if flaskbb_config["REGISTRATION_ENABLED"] %}
                                        <li><a href="{{ url_for('auth.register') }}"><span class="fa fa-user-plus fa-fw"></span> {% trans %}Register{% endtrans %}</a></li>
                                        {% endif %}
                                        <li><a href="{{ url_for('auth.forgot_password') }}"><span class="fa fa-undo fa-fw"></span> {% trans %}Reset Password{% endtrans %}</a></li>
                                    </ul>
                                </div>
                            </li>
                            {% endif %}

                        </ul> <!-- end navbar right -->
                    </div> <!-- end navbar-collapse -->
                </div> <!-- end navbar -->
                {% endblock %}

                <!-- Place for all the (flashed) messages -->
                {% block messages %}
                <div id="flashed-messages">
                    {% include theme('flashed_messages.html') %}
                </div>
                {% endblock %}

                <!-- the actual content block -->
                {% block content %}
                {% endblock %}
            </div> <!-- end container -->

            <!-- the forum footer -->
            {% block footer %}
            <footer class="flaskbb-footer">
                <div class="container">
                    <p class="text-muted pull-left">&copy; 2017 WOSTRAQ</p>
                </div>
            </footer>
            {% endblock %}

        </div> <!-- end flaskbb-layout -->

        {% block javascript %}
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
        <!-- Enable tooltips in all templates -->
        <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
        </script>
        {% endblock %}

        {# for extra scripts in other templates. #}
        {% block scripts %}
        {% endblock %}
    </body>
</html>
